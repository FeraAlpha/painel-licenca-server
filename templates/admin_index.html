<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<title>Fera Alpha — Painel</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<style>
  :root{
    --bg:#c5c9ce;               /* CINZA MAIS ESCURO */
    --card:#f3f4f6;             /* cinza claro */
    --border:#cfd2d6;
    --text:#2a2f35;
    --text-light:#59616a;
    --accent:#2f6fed;
    --danger:#d93c3c;
    --radius:10px;
  }

  *{margin:0;padding:0;box-sizing:border-box;font-family:"Inter",Arial;}

  body{
    background:var(--bg);
    padding:24px;
    color:var(--text);
  }

  h1{
    font-size:26px;
    font-weight:700;
    margin-bottom:14px;
  }

  .card{
    background:var(--card);
    border:1px solid var(--border);
    padding:20px;
    border-radius:var(--radius);
    margin-bottom:20px;
    box-shadow:0 2px 6px rgba(0,0,0,0.07);
  }

  label{
    font-size:14px;
    color:var(--text-light);
    margin-bottom:4px;
    display:block;
  }

  input{
    width:100%;
    padding:10px;
    border:1px solid var(--border);
    border-radius:6px;
    margin-bottom:12px;
    font-size:14px;
    background:white;
    color:var(--text);
  }

  .btn{
    padding:10px 16px;
    border:none;
    border-radius:6px;
    font-weight:600;
    cursor:pointer;
    font-size:14px;
  }

  .btn-primary{
    background:var(--accent);
    color:white;
  }

  .btn-danger{
    background:var(--danger);
    color:white;
  }

  table{
    width:100%;
    border-collapse:collapse;
    font-size:14px;
  }

  thead th{
    text-align:left;
    padding:10px;
    font-weight:600;
    background:#e7e9ee;
    border-bottom:1px solid var(--border);
    color:var(--text-light);
  }

  tbody td{
    padding:10px;
    border-bottom:1px solid var(--border);
  }

  tbody tr:hover{
    background:#e9ebef;
  }

  .badge{
    padding:4px 10px;
    border-radius:20px;
    font-size:12px;
    font-weight:600;
    display:inline-block;
  }

  .badge-ok{
    background:#d6f5df;
    color:#1a7431;
  }

  .badge-warn{
    background:#fff2cd;
    color:#9a742b;
  }

  .badge-exp{
    background:#f8d7da;
    color:#b02a37;
  }

  .copy{
    color:var(--accent);
    cursor:pointer;
    font-weight:600;
    margin-left:6px;
  }
</style>
</head>

<body>

<h1>Fera Alpha — Painel</h1>

<!-- Criar Key -->
<div class="card">
  <h2 style="font-size:18px;margin-bottom:10px;">Gerar nova key</h2>

  <form method="post" action="/admin/generate">
    <label>Usuário</label>
    <input type="text" name="username" placeholder="ex: cliente01" required>

    <label>Senha</label>
    <input type="text" name="password" placeholder="senha do cliente" required>

    <label>Prefixo</label>
    <input type="text" name="prefix" value="FERA">

    <label>Expiração (dias)</label>
    <input type="number" name="expire_days" value="30">

    <button class="btn btn-primary">Gerar Key</button>
  </form>
</div>

<!-- Lista -->
<div class="card">
  <h2 style="font-size:18px">Usuários cadastrados</h2>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Usuário</th>
        <th>Key</th>
        <th>Device</th>
        <th>Expiração</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ loop.index0 }}</td>
        <td>{{ u.username }}</td>

        <td>
          {{ u.key }}
          <span class="copy" onclick="navigator.clipboard.writeText('{{ u.key }}')">copiar</span>
        </td>

        <td>{{ u.device_id if u.device_id else '-' }}</td>

        <td>
          {% if u.expires_at %}
            {% set now = (datetime.now().timestamp()) %}
            {% set diff = (u.expires_at - now) / 86400 %}
            {% if diff < 0 %}
              <span class="badge badge-exp">Expirado</span>
            {% elif diff < 7 %}
              <span class="badge badge-warn">{{ diff|round }} dias</span>
            {% else %}
              <span class="badge badge-ok">{{ diff|round }} dias</span>
            {% endif %}
          {% else %}
            <span class="badge badge-ok">Ilimitada</span>
          {% endif %}
        </td>

        <td>
          <form method="post" action="/admin/delete/{{ loop.index0 }}">
            <button class="btn btn-danger">Excluir</button>
          </form>
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

</body>
            </html>
