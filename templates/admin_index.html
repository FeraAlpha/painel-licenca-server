<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<title>Fera Alpha — Painel Administrativo</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  :root {
    --bg: #f0f2f5;
    --card: #ffffff;
    --border: #d1d9e6;
    --text: #1a1d21;
    --text-light: #6c757d;
    --accent: #4361ee;
    --accent-hover: #3a56d4;
    --danger: #e63946;
    --danger-hover: #d32f3d;
    --ok: #2a9d8f;
    --warning: #f4a261;
    --radius: 12px;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    --transition: all 0.2s ease;
  }

  .dark-mode {
    --bg: #0f1419;
    --card: #1a1f26;
    --border: #2d3746;
    --text: #e9ecef;
    --text-light: #8b9bb4;
    --accent: #5a7dff;
    --accent-hover: #6b8cff;
    --danger: #ff6b6b;
    --danger-hover: #ff5252;
    --ok: #4cc9b0;
    --warning: #ffb347;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  }

  body {
    background: var(--bg);
    color: var(--text);
    padding: 20px;
    min-height: 100vh;
    transition: var(--transition);
  }

  /* HEADER */
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }

  .header-title h1 {
    font-size: 28px;
    font-weight: 700;
    background: linear-gradient(90deg, var(--accent), #6c8eff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 4px;
  }

  .header-subtitle {
    font-size: 14px;
    color: var(--text-light);
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .header-subtitle i {
    color: var(--ok);
  }

  /* CONTROLS */
  .controls {
    display: flex;
    gap: 12px;
    align-items: center;
  }

  /* CARDS */
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    padding: 24px;
    border-radius: var(--radius);
    margin-bottom: 24px;
    box-shadow: var(--shadow);
    transition: var(--transition);
  }

  .card:hover {
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
  }

  .card-title {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--text);
  }

  .card-title i {
    color: var(--accent);
  }

  /* FORMS */
  .form-group {
    margin-bottom: 18px;
  }

  label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text);
    font-size: 14px;
  }

  input, select {
    width: 100%;
    padding: 12px 16px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--bg);
    color: var(--text);
    font-size: 15px;
    transition: var(--transition);
  }

  input:focus, select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
  }

  /* BUTTONS */
  .btn {
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    border: none;
    font-size: 14px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: var(--transition);
    white-space: nowrap;
  }

  .btn-sm {
    padding: 8px 14px;
    font-size: 13px;
  }

  .btn-primary {
    background: var(--accent);
    color: white;
  }

  .btn-primary:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
  }

  .btn-danger {
    background: var(--danger);
    color: white;
  }

  .btn-danger:hover {
    background: var(--danger-hover);
    transform: translateY(-1px);
  }

  .btn-outline {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text);
  }

  .btn-outline:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: var(--accent);
  }

  .btn-warning {
    background: var(--warning);
    color: #1a1d21;
  }

  .btn-warning:hover {
    opacity: 0.9;
  }

  .btn-success {
    background: var(--ok);
    color: white;
  }

  .btn-group {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 10px;
  }

  /* ADMIN TOOLS */
  .admin-tools {
    display: flex;
    gap: 15px;
    margin-bottom: 25px;
    flex-wrap: wrap;
  }

  .admin-tools form {
    display: inline-block;
  }

  /* TABLE */
  .table-container {
    overflow-x: auto;
    border-radius: var(--radius);
    border: 1px solid var(--border);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
    min-width: 1200px;
  }

  thead {
    background: var(--bg);
    position: sticky;
    top: 0;
  }

  thead th {
    padding: 16px 12px;
    text-align: left;
    font-weight: 600;
    color: var(--text);
    border-bottom: 2px solid var(--border);
    cursor: pointer;
    user-select: none;
    transition: var(--transition);
  }

  thead th:hover {
    background: rgba(0, 0, 0, 0.03);
  }

  thead th i {
    margin-left: 5px;
    font-size: 12px;
    opacity: 0.6;
  }

  tbody td {
    padding: 16px 12px;
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
  }

  tbody tr {
    transition: var(--transition);
  }

  tbody tr:hover {
    background: rgba(0, 0, 0, 0.02);
  }

  .dark-mode tbody tr:hover {
    background: rgba(255, 255, 255, 0.03);
  }

  /* BADGES */
  .badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 5px;
    white-space: nowrap;
  }

  .badge-ok { background: rgba(42, 157, 143, 0.15); color: var(--ok); }
  .badge-warn { background: rgba(244, 162, 97, 0.15); color: var(--warning); }
  .badge-exp { background: rgba(230, 57, 70, 0.15); color: var(--danger); }
  .badge-unl { background: rgba(67, 97, 238, 0.15); color: var(--accent); }

  /* ACTIONS CELL */
  .actions-cell {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .copy-btn {
    color: var(--accent);
    cursor: pointer;
    margin-left: 8px;
    transition: var(--transition);
  }

  .copy-btn:hover {
    color: var(--accent-hover);
    transform: scale(1.1);
  }

  /* SEARCH */
  .search-box {
    position: relative;
    margin-bottom: 20px;
    max-width: 400px;
  }

  .search-box input {
    padding-left: 40px;
  }

  .search-box i {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-light);
  }

  /* STATS */
  .stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 20px;
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .stat-value {
    font-size: 32px;
    font-weight: 700;
    margin: 10px 0;
  }

  .stat-label {
    font-size: 14px;
    color: var(--text-light);
  }

  /* TOAST */
  .toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--card);
    border: 1px solid var(--border);
    padding: 16px 20px;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    gap: 12px;
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 1000;
  }

  .toast.show {
    transform: translateY(0);
    opacity: 1;
  }

  .toast-success {
    border-left: 4px solid var(--ok);
  }

  .toast-error {
    border-left: 4px solid var(--danger);
  }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    body {
      padding: 15px;
    }
    
    .admin-tools, .btn-group {
      flex-direction: column;
    }
    
    .admin-tools form, .btn-group form {
      width: 100%;
    }
    
    .btn {
      width: 100%;
      justify-content: center;
    }
    
    .table-container {
      border: none;
    }
  }
</style>
</head>

<body>

<!-- TOAST NOTIFICATION -->
<div id="toast" class="toast">
  <i id="toast-icon"></i>
  <span id="toast-message"></span>
</div>

<header>
  <div class="header-title">
    <h1><i class="fas fa-shield-alt"></i> Fera Alpha Admin</h1>
    <div class="header-subtitle">
      <i class="fas fa-cogs"></i>
      <span>Painel de gerenciamento avançado</span>
    </div>
  </div>

  <div class="controls">
    <button class="btn btn-outline" onclick="toggleDark()">
      <i class="fas fa-moon"></i>
      <span>Tema</span>
    </button>
  </div>
</header>

<!-- STATS -->
<div class="stats-container">
  <div class="stat-card">
    <i class="fas fa-users" style="font-size: 24px; color: var(--accent);"></i>
    <div class="stat-value" id="totalUsers">{{ users|length }}</div>
    <div class="stat-label">Total Usuários</div>
  </div>
  <div class="stat-card">
    <i class="fas fa-key" style="font-size: 24px; color: var(--ok);"></i>
    <div class="stat-value" id="activeKeys">{{ users|selectattr('device_id')|list|length }}</div>
    <div class="stat-label">Keys Ativas</div>
  </div>
  <div class="stat-card">
    <i class="fas fa-clock" style="font-size: 24px; color: var(--warning);"></i>
    <div class="stat-value" id="expiringSoon">0</div>
    <div class="stat-label">Expirando em 7 dias</div>
  </div>
  <div class="stat-card">
    <i class="fas fa-infinity" style="font-size: 24px; color: var(--accent);"></i>
    <div class="stat-value" id="unlimitedKeys">{{ users|selectattr('expires_at', 'equalto', 0)|list|length }}</div>
    <div class="stat-label">Ilimitados</div>
  </div>
</div>

<!-- ADMIN TOOLS -->
<div class="admin-tools">
  <form method="post" action="/admin/reset_all_devices" 
        onsubmit="return confirm('⚠️ Resetar TODOS os devices? Esta ação não pode ser desfeita.')">
    <button type="submit" class="btn btn-warning">
      <i class="fas fa-sync-alt"></i>
      Resetar Todos Devices
    </button>
  </form>
  
  <form method="post" action="/admin/clean_expired" 
        onsubmit="return confirm('Remover TODOS os usuários expirados?')">
    <button type="submit" class="btn btn-danger">
      <i class="fas fa-trash-alt"></i>
      Limpar Expirados
    </button>
  </form>

  <button class="btn btn-outline" onclick="refreshStats()">
    <i class="fas fa-redo"></i>
    Atualizar
  </button>
</div>

<!-- GERAR KEY -->
<div class="card">
  <div class="card-title">
    <i class="fas fa-key"></i>
    Gerar Nova Licença
  </div>

  <form method="post" action="/admin/generate" id="generateForm">
    <div class="form-group">
      <label>Usuário</label>
      <input name="username" required placeholder="Digite o nome de usuário">
    </div>

    <div class="form-group">
      <label>Senha</label>
      <input name="password" required placeholder="Digite a senha">
    </div>

    <div class="form-group">
      <label>Prefixo da Key</label>
      <input name="prefix" value="FERA" placeholder="Ex: FERA">
    </div>

    <div class="form-group">
      <label>Expiração (dias)</label>
      <input name="expire_days" type="number" value="30" min="0" placeholder="0 para ilimitado">
      <small style="color: var(--text-light); font-size: 13px; margin-top: 5px; display: block;">
        Digite 0 para criar uma licença ilimitada
      </small>
    </div>
    
    <div class="btn-group">
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-plus-circle"></i>
        Gerar Licença
      </button>
      <button type="button" class="btn btn-outline" onclick="setExpiration('30')">
        <i class="fas fa-calendar-day"></i>
        30 Dias
      </button>
      <button type="button" class="btn btn-outline" onclick="setExpiration('90')">
        <i class="fas fa-calendar-week"></i>
        90 Dias
      </button>
      <button type="button" class="btn btn-outline" onclick="setExpiration('0')">
        <i class="fas fa-infinity"></i>
        Ilimitado
      </button>
    </div>
  </form>
</div>

<!-- BUSCA -->
<div class="search-box">
  <i class="fas fa-search"></i>
  <input id="searchUser" placeholder="Buscar por usuário, key, device ou status...">
</div>

<!-- TABELA -->
<div class="card">
  <div class="card-title">
    <i class="fas fa-table"></i>
    Gerenciamento de Licenças
  </div>

  <div class="table-container">
    <table id="usersTable">
      <thead>
        <tr>
          <th onclick="sortTable(0)">
            ID <i class="fas fa-sort"></i>
          </th>
          <th onclick="sortTable(1)">
            Usuário <i class="fas fa-sort"></i>
          </th>
          <th>Credenciais</th>
          <th>Licença</th>
          <th>Device ID</th>
          <th onclick="sortTable(5)">
            Status <i class="fas fa-sort"></i>
          </th>
          <th>Ações</th>
        </tr>
      </thead>

      <tbody>
        {% for u in users %}
        <tr data-expires="{{ u.expires_at }}" data-user="{{ u.username|lower }}" data-key="{{ u.key|lower }}" data-device="{{ u.device_id|lower if u.device_id else '' }}">
          <td>
            <span class="badge badge-unl">{{ loop.index0 }}</span>
          </td>

          <td>
            <strong>{{ u.username }}</strong>
          </td>

          <td>
            <div style="display: flex; align-items: center;">
              <span style="font-family: monospace; background: var(--bg); padding: 4px 8px; border-radius: 4px; font-size: 13px;">
                {{ u.username }}:{{ u.password }}
              </span>
              <span class="copy-btn" onclick="copyCredentials('{{ u.username }}', '{{ u.password }}')" title="Copiar credenciais">
                <i class="fas fa-copy"></i>
              </span>
            </div>
          </td>

          <td>
            <div style="display: flex; align-items: center;">
              <code style="font-family: monospace; background: var(--bg); padding: 4px 8px; border-radius: 4px; font-size: 13px;">
                {{ u.key }}
              </code>
              <span class="copy-btn" onclick="copyToClipboard('{{ u.key }}')" title="Copiar key">
                <i class="fas fa-copy"></i>
              </span>
            </div>
          </td>

          <td>
            {% if u.device_id %}
            <span class="badge badge-ok">
              <i class="fas fa-laptop"></i>
              {{ u.device_id[:8] }}...
            </span>
            {% else %}
            <span class="badge badge-warn">
              <i class="fas fa-times"></i>
              Não vinculado
            </span>
            {% endif %}
          </td>

          <td class="expCell">
            <!-- Preenchido via JavaScript -->
          </td>

          <td>
            <div class="actions-cell">
              <!-- +30 Dias -->
              <form method="post" action="/admin/renew/{{ loop.index0 }}">
                <button type="submit" class="btn btn-sm btn-primary" title="Adicionar 30 dias">
                  <i class="fas fa-calendar-plus"></i>
                </button>
              </form>

              <!-- + Dias Custom -->
              <form method="post" action="/admin/renew_custom/{{ loop.index0 }}" style="display: flex; gap: 4px;">
                <input type="number" name="days" min="1" value="7" 
                       style="width: 60px; padding: 6px; font-size: 13px;">
                <button type="submit" class="btn btn-sm btn-primary" title="Adicionar dias personalizados">
                  <i class="fas fa-plus"></i>
                </button>
              </form>

              <!-- Make Unlimited -->
              <form method="post" action="/admin/make_unlimited/{{ loop.index0 }}"
                    onsubmit="return confirm('Tornar esta licença ilimitada?')">
                <button type="submit" class="btn btn-sm btn-success" title="Tornar ilimitado">
                  <i class="fas fa-infinity"></i>
                </button>
              </form>

              <!-- Reset Key -->
              <form method="post" action="/admin/reset/{{ loop.index0 }}">
                <button type="submit" class="btn btn-sm btn-outline" title="Resetar Key">
                  <i class="fas fa-redo"></i>
                </button>
              </form>

              <!-- Reset Device -->
              <form method="post" action="/admin/reset_device/{{ loop.index0 }}">
                <button type="submit" class="btn btn-sm btn-danger" title="Resetar Device">
                  <i class="fas fa-unlink"></i>
                </button>
              </form>

              <!-- Delete -->
              <form method="post" action="/admin/delete/{{ loop.index0 }}"
                    onsubmit="return confirm('Tem certeza que deseja excluir este usuário?')">
                <button type="submit" class="btn btn-sm btn-danger" title="Excluir usuário">
                  <i class="fas fa-trash"></i>
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
// TEMA
function toggleDark() {
  document.body.classList.toggle('dark-mode');
  localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
  showToast('Tema alterado', 'success');
}

// Verificar tema salvo
if (localStorage.getItem('darkMode') === 'true') {
  document.body.classList.add('dark-mode');
}

// EXPIRAÇÃO
function setExpiration(days) {
  const input = document.querySelector('input[name="expire_days"]');
  input.value = days;
  
  if (days === '0') {
    showToast('Licença será criada como ILIMITADA!', 'info');
  } else {
    showToast(`Expiração definida para ${days} dias`, 'success');
  }
}

// COPIAR
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => {
    showToast('Copiado para a área de transferência!', 'success');
  }).catch(err => {
    console.error('Erro ao copiar:', err);
    showToast('Erro ao copiar', 'error');
  });
}

function copyCredentials(username, password) {
  const text = `Usuário: ${username}\nSenha: ${password}`;
  copyToClipboard(text);
}

// BUSCA
document.getElementById('searchUser').addEventListener('input', function() {
  const query = this.value.toLowerCase().trim();
  const rows = document.querySelectorAll('#usersTable tbody tr');
  
  rows.forEach(row => {
    const user = row.getAttribute('data-user');
    const key = row.getAttribute('data-key');
    const device = row.getAttribute('data-device');
    const expires = row.getAttribute('data-expires');
    
    const now = Math.floor(Date.now() / 1000);
    const exp = parseInt(expires);
    let status = '';
    
    if (exp === 0 || exp === 9999999999999) {
      status = 'ilimitado';
    } else if (exp < now) {
      status = 'expirado';
    } else {
      const diff = Math.floor((exp - now) / 86400);
      if (diff < 3) status = 'crítico';
      else if (diff < 7) status = 'atenção';
      else status = 'ativo';
    }
    
    const matches = user.includes(query) || 
                   key.includes(query) || 
                   device.includes(query) ||
                   status.includes(query) ||
                   row.textContent.toLowerCase().includes(query);
    
    row.style.display = matches ? '' : 'none';
  });
});

// ORDENAÇÃO
let currentSort = { column: 0, direction: 'asc' };

function sortTable(column) {
  const table = document.getElementById('usersTable');
  const tbody = table.tBodies[0];
  const rows = Array.from(tbody.rows);
  
  const isSameColumn = currentSort.column === column;
  currentSort.direction = isSameColumn && currentSort.direction === 'asc' ? 'desc' : 'asc';
  currentSort.column = column;
  
  rows.sort((a, b) => {
    let aVal = a.cells[column].textContent.trim();
    let bVal = b.cells[column].textContent.trim();
    
    // Para coluna de status
    if (column === 5) {
      aVal = getExpirationStatus(a.getAttribute('data-expires'));
      bVal = getExpirationStatus(b.getAttribute('data-expires'));
    }
    
    // Para coluna numérica (ID)
    if (column === 0) {
      aVal = parseInt(aVal) || 0;
      bVal = parseInt(bVal) || 0;
    }
    
    const direction = currentSort.direction === 'asc' ? 1 : -1;
    
    if (aVal < bVal) return -1 * direction;
    if (aVal > bVal) return 1 * direction;
    return 0;
  });
  
  // Remover e re-adicionar linhas na ordem correta
  rows.forEach(row => tbody.appendChild(row));
  
  // Atualizar ícones de ordenação
  updateSortIcons();
}

function getExpirationStatus(expires) {
  const exp = parseInt(expires);
  if (exp === 0 || exp === 9999999999999) return 3; // Ilimitado
  const now = Math.floor(Date.now() / 1000);
  if (exp < now) return 0; // Expirado
  const diff = Math.floor((exp - now) / 86400);
  if (diff < 3) return 1; // Crítico
  if (diff < 7) return 2; // Atenção
  return 3; // OK
}

function updateSortIcons() {
  const headers = document.querySelectorAll('#usersTable thead th i');
  headers.forEach((icon, index) => {
    icon.className = 'fas fa-sort';
    if (index === currentSort.column) {
      icon.className = currentSort.direction === 'asc' ? 'fas fa-sort-up' : 'fas fa-sort-down';
    }
  });
}

// RENDERIZAR STATUS
function renderExpirationStatus() {
  const now = Math.floor(Date.now() / 1000);
  let expiringSoonCount = 0;
  
  document.querySelectorAll('tr[data-expires]').forEach(tr => {
    const exp = parseInt(tr.getAttribute('data-expires'));
    const cell = tr.querySelector('.expCell');
    
    if (!exp || exp === 0 || exp === 9999999999999) {
      cell.innerHTML = `<span class="badge badge-unl"><i class="fas fa-infinity"></i> Ilimitado</span>`;
      return;
    }
    
    if (exp < now) {
      cell.innerHTML = `<span class="badge badge-exp"><i class="fas fa-exclamation-circle"></i> Expirado</span>`;
      return;
    }
    
    const diff = Math.floor((exp - now) / 86400);
    
    if (diff < 3) {
      cell.innerHTML = `<span class="badge badge-exp"><i class="fas fa-exclamation-triangle"></i> ${diff} dias</span>`;
    } else if (diff < 7) {
      cell.innerHTML = `<span class="badge badge-warn"><i class="fas fa-clock"></i> ${diff} dias</span>`;
      expiringSoonCount++;
    } else {
      cell.innerHTML = `<span class="badge badge-ok"><i class="fas fa-check-circle"></i> ${diff} dias</span>`;
    }
  });
  
  // Atualizar estatísticas
  document.getElementById('expiringSoon').textContent = expiringSoonCount;
}

// TOAST NOTIFICATION
function showToast(message, type = 'success') {
  const toast = document.getElementById('toast');
  const toastIcon = document.getElementById('toast-icon');
  const toastMessage = document.getElementById('toast-message');
  
  toast.className = 'toast';
  
  if (type === 'success') {
    toast.classList.add('toast-success');
    toastIcon.className = 'fas fa-check-circle';
    toastIcon.style.color = 'var(--ok)';
  } else if (type === 'error') {
    toast.classList.add('toast-error');
    toastIcon.className = 'fas fa-exclamation-circle';
    toastIcon.style.color = 'var(--danger)';
  } else {
    toastIcon.className = 'fas fa-info-circle';
    toastIcon.style.color = 'var(--accent)';
  }
  
  toastMessage.textContent = message;
  toast.classList.add('show');
  
  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
}

// ATUALIZAR ESTATÍSTICAS
function refreshStats() {
  const totalUsers = document.querySelectorAll('tr[data-expires]').length;
  const activeKeys = document.querySelectorAll('.badge-ok').length;
  const unlimitedKeys = document.querySelectorAll('.badge-unl').length;
  
  document.getElementById('totalUsers').textContent = totalUsers;
  document.getElementById('activeKeys').textContent = activeKeys;
  document.getElementById('unlimitedKeys').textContent = unlimitedKeys;
  
  renderExpirationStatus();
  showToast('Estatísticas atualizadas', 'success');
}

// AUTO-REFRESH
renderExpirationStatus();
setInterval(renderExpirationStatus, 30000); // Atualiza a cada 30 segundos

// Inicializar ícones de ordenação
updateSortIcons();

// Confirmar envio do formulário de geração
document.getElementById('generateForm').addEventListener('submit', function(e) {
  const days = parseInt(this.querySelector('input[name="expire_days"]').value);
  if (days === 0) {
    if (!confirm('⚠️ Criar licença ILIMITADA? Esta ação não pode ser desfeita facilmente.')) {
      e.preventDefault();
    }
  }
});
</script>

</body>
</html>
