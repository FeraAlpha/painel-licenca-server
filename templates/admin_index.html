<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8"/>

    <!-- üî• ANTI-CACHE (OBRIGAT√ìRIO PARA MUDAN√áAS APARECEREM) -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Fera Alpha ‚Äî Painel</title>

    <style>
        :root{
            --bg:#bfc3c9;        /* Fundo cinza mais escuro */
            --card:#ffffff;      /* Cart√µes brancos */
            --border:#d0d3d6;
            --text:#2b2f33;
            --text-light:#6d7480;
            --accent:#2f6fed;    /* Bot√£o azul */
            --danger:#d93c3c;    /* Bot√£o vermelho */
            --radius:14px;
        }

        *{
            margin:0;
            padding:0;
            box-sizing:border-box;
            font-family:Arial, sans-serif;
        }

        body{
            background:var(--bg);
            padding:28px;
            color:var(--text);
        }

        h1{
            font-size:30px;
            font-weight:700;
            margin-bottom:25px;
        }

        .card{
            background:var(--card);
            padding:22px;
            border-radius:var(--radius);
            border:1px solid var(--border);
            margin-bottom:28px;
            max-width:600px;
            box-shadow:0 3px 8px rgba(0,0,0,0.10);
        }

        label{
            font-size:15px;
            font-weight:600;
            margin-top:12px;
            display:block;
            color:var(--text-light);
        }

        input{
            padding:12px;
            width:100%;
            border-radius:var(--radius);
            border:1px solid var(--border);
            margin-top:6px;
            margin-bottom:10px;
            font-size:15px;
        }

        .btn{
            background:var(--accent);
            color:#fff;
            padding:14px;
            border:none;
            border-radius:var(--radius);
            font-size:16px;
            font-weight:600;
            width:100%;
            cursor:pointer;
        }

        .btn-danger{
            background:var(--danger);
            color:#fff;
            padding:10px 16px;
            border:none;
            border-radius:var(--radius);
            cursor:pointer;
            font-size:15px;
        }

        table{
            width:100%;
            border-collapse:collapse;
            margin-top:10px;
        }

        th{
            text-align:left;
            background:#eff2f5;
            padding:12px;
            border-bottom:1px solid var(--border);
            font-size:14px;
        }

        td{
            padding:12px;
            border-bottom:1px solid var(--border);
            font-size:14px;
            word-break:break-word;
        }

        .badge{
            background:#b4f2c0;
            padding:6px 14px;
            border-radius:30px;
            font-size:13px;
            font-weight:600;
            color:#1c5d2c;
            display:inline-block;
            text-align:center;
            min-width:70px;
        }

        .copy{
            color:#2f6fed;
            text-decoration:underline;
            cursor:pointer;
            font-size:13px;
        }
    </style>
</head>

<body>

    <h1>Fera Alpha ‚Äî Painel</h1>

    <!-- CARD GERAR NOVA KEY -->
    <div class="card">
        <h2 style="margin-bottom:15px;">Gerar nova key</h2>

        <form method="post" action="/admin/generate">

            <label>Usu√°rio</label>
            <input name="username" placeholder="ex: cliente01">

            <label>Senha</label>
            <input name="password" placeholder="senha do cliente">

            <label>Prefixo</label>
            <input name="prefix" value="FERA">

            <label>Expira√ß√£o (dias)</label>
            <input name="expire_days" type="number" value="30">

            <button class="btn">Gerar Key</button>
        </form>
    </div>

    <!-- CARD TABELA -->
    <div class="card">
        <h2 style="margin-bottom:15px;">Usu√°rios cadastrados</h2>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Usu√°rio</th>
                    <th>Key</th>
                    <th>Device</th>
                    <th>Expira√ß√£o</th>
                    <th>A√ß√£o</th>
                </tr>
            </thead>

            <tbody>
                {% for u in users %}
                <tr>
                    <td>{{ loop.index0 }}</td>
                    <td>{{ u.username }}</td>

                    <td>
                        {{ u.key }}  
                        <br>
                        <span class="copy" onclick="navigator.clipboard.writeText('{{u.key}}')">copiar</span>
                    </td>

                    <td>{{ u.device_id or "-" }}</td>

                    <td>
                        <span class="badge">
                            {{ "%.1f"|format((u.expires_at - (datetime.utcnow().timestamp())) / 86400) }} dias
                        </span>
                    </td>

                    <td>
                        <form method="post" action="/admin/delete/{{ loop.index0 }}">
                            <button class="btn-danger">Excluir</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

    </div>

</body>
</html>
